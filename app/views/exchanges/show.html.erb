<div class="container">
<h1>DÃ©tail de l'Ã©change</h1>

<p><strong>Demandeur :</strong> <%= @exchange.initiator.username %></p>
<p><strong>Destinataire :</strong> <%= @exchange.recipient.username %></p>
<p><strong>Manga souhaitÃ© :</strong> <%= @exchange.wanted_manga.db_manga.title %></p>

<% if @exchange.offered_manga %>
  <p><strong>Manga proposÃ© :</strong> <%= @exchange.offered_manga.db_manga.title %></p>
<% end %>

<p><strong>Message initial :</strong> <%= @exchange.initial_message %></p>
<p><strong>Status :</strong> <%= @exchange.status.humanize %></p>

<% if @exchange.scheduled_at.present? %>
  <p><strong>ğŸ“… Ã‰change prÃ©vu le :</strong> <%= l(@exchange.scheduled_at, format: :long) %></p>
<% else %>
  <p><em>Aucune date dâ€™Ã©change prÃ©vue pour le moment.</em></p>
<% end %>



<% if @exchange.recipient == current_user %>

  <p>
    <%= button_to "Accepter", update_status_exchange_path(@exchange, status: "accepted"), method: :patch, class: "btn btn-success" %>
  </p>
  <p>
    <%= button_to "Refuser", update_status_exchange_path(@exchange, status: "refused"), method: :patch, class: "btn btn-danger" %>
  </p>
  <% end %>

<% if @exchange.status == "accepted" %>
  <% if @exchange.chat.present? %>
    <%= link_to "ğŸ’¬ Ouvrir le chat", chat_path(@exchange.chat), class: "btn btn-info" %>
  <% else %>
    <%= button_to "ğŸ’¬ DÃ©marrer un chat", start_chat_exchange_path(@exchange), method: :post, class: "btn btn-primary" %>
  <% end %>
<% end %>


<%= link_to "Choisir un manga en Ã©change", edit_exchange_path(@exchange), class: "btn btn-primary" %>
<%= link_to "Retour aux Ã©changes", exchanges_path, class: "btn btn-secondary" %>
</div>
