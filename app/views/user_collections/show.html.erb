<!-- app/views/user_collections/show.html.erb -->
<div class="collection-detail">
  <h1><%= @user_collection.name %></h1>

  <div class="collection-stats">
    <p>Nombre de mangas : <%= @owned_mangas.count %></p>
  </div>

  <div class="owned-mangas-grid">
    <% if @owned_mangas.any? %>
      <div class="row">
        <% @owned_mangas.each do |owned_manga| %>
          <div class="col-md-4 col-sm-6 mb-4">
            <div class="manga-card">
              <!-- Informations du manga via la relation db_manga -->
              <h3><%= owned_manga.db_manga.title %></h3>

              <% if owned_manga.db_manga.image_url.present? %>
                <%= image_tag owned_manga.db_manga.image_url,
                              alt: owned_manga.db_manga.title,
                              class: "manga-cover" %>
              <% end %>
              <div class="manga-info">
                <p class="author">Par : <%= owned_manga.db_manga.author %></p>
                <p class="genre"><%= owned_manga.db_manga.genre %></p>

                <!-- Informations spécifiques à la possession -->

              </div>


            </div>
            <div class="manga-actions">
                <%= link_to "Détails",
                            user_collection_owned_manga_path(@user_collection, owned_manga),
                            class: "btn btn-sm btn-primary" %>

                <%= form_with url: user_collection_owned_manga_path(@user_collection, owned_manga),
                  method: :delete,
                  data: { turbo_confirm: "Êtes-vous sûr ?" },
                  class: "inline-form" do %>
                  <%= submit_tag "Retirer", class: "btn btn-sm btn-danger" %>
                <% end %>
              </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="empty-collection">
        <p>Aucun manga dans cette collection pour le moment.</p>
        <%= link_to "Parcourir les mangas", db_mangas_path, class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>

  <div class="collection-actions mt-4">
    <%= link_to "Ajouter un manga", db_mangas_path, class: "btn btn-primary" %>
    <%= form_with url: user_collection_path(@user_collection), method: :delete, data: { turbo_confirm: "Êtes-vous sûr ?" } do %>
    <%= submit_tag "Supprimer la collection", class: "btn btn-danger" %>
    <% end %>
    <%= link_to "Retour aux collections", user_collections_path,
                class: "btn btn-light" %>
  </div>
</div>
